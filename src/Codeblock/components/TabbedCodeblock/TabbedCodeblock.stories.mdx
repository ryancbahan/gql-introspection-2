import {Canvas, Meta, Story, ArgsTable} from '@storybook/addon-docs';
import {mockActionsSimple, mockActions} from 'app/ui/mocks/Codeblock';
import {CardTitled, CodeblockContent} from 'app/ui/components/Codeblock';

import {TabbedCodeblock} from './TabbedCodeblock';

<Meta title="Codeblock/TabbedCodeblock" component={TabbedCodeblock} />

# Tabbed Codeblocks in a Card

This is the intended direction for the future of codeblocks!
We have simplified the component structure to favour composition over configuration.
The components are split into these levels so that their presentational concerns are separated:

- Card (internal to codeblock) -> CardTitled -> `<children>`
- `children`, usually: Tabbed (internal / "abstract" tabs implementation) -> TabbedCodeblock[] -> CodeblockContent[]

> ### An aside about the `ControlledTabbedCodeblock`:
>
> The `ControlledTabbedCodeblock` is [only] a super-set of the `TabbedCodeblock` component, i.e. just a wrapper for the convenience of type enforcement.
> It enforces `react-tabs`' notion of controlled tabs, by requiring that the `selectedIndex` AND `onSelect` props are provided.
> See the docs here: https://github.com/reactjs/react-tabs#controlled-vs-uncontrolled-mode
> At time of writing, _most_ of the uses of the codeblock on shopify.dev are actually just "uncontrolled" TabbedCodeblocks, coming from the liquid markdown docs.

<ArgsTable of={TabbedCodeblock} />

Secondary Props:

>

- `tabs` Array of tab objects
  - `key` Unique identifier key
  - `title` Tab title
  - `content` Content to be displayed in tab

---

The main supported compositions use nested subitems to create a larger component:

<Canvas>
  <Story name="Nested">
    <CardTitled titleProps={{content: 'Nested', actions: []}}>
      <>
        <TabbedCodeblock
          nested
          prefix="Prefix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          postfix="Postfix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          postfix="Postfix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          nested
          prefix="Prefix"
          postfix="Postfix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent
                  content="var foo = 'This codeblock should have a prefix, a postfix, and actions.';"
                  language="js"
                />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
      </>
    </CardTitled>
  </Story>
</Canvas>

Here is an example that is not officially supported that uses un-nested inner components:

<Canvas>
  <Story name="Non-nested">
    <CardTitled
      titleProps={{
        content: 'Non Nested',
        actions: [],
      }}
    >
      <>
        <TabbedCodeblock
          prefix="Prefix"
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
          ]}
        />
        <TabbedCodeblock
          prefix="Prefix"
          actions={mockActionsSimple}
          tabs={[
            {
              key: '01',
              title: 'javascript',
              content: (
                <CodeblockContent content="var foo = bar;" language="js" />
              ),
            },
            {
              key: '02',
              title: 'ts',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
      </>
    </CardTitled>
  </Story>
</Canvas>

This is the "Super Stack" for multiple dimensions of information, e.g. examples involving multiple categories and programming languages:

<Canvas>
  <Story name="Super Stack">
    <CardTitled
      titleProps={{
        content: 'Super Stack with multiple dimensions',
        actions: [],
      }}
    >
      <>
        <TabbedCodeblock
          actions={mockActions}
          tabs={[
            {
              key: '01',
              title: 'item',
              content: (
                <TabbedCodeblock
                  nested
                  prefix="title"
                  actions={mockActionsSimple}
                  tabs={[
                    {
                      key: '01',
                      title: 'javascript',
                      content: (
                        <CodeblockContent
                          content="var foo = bar;"
                          language="js"
                        />
                      ),
                    },
                    {
                      key: '02',
                      title: 'ts',
                      content: (
                        <CodeblockContent
                          content="const foo: string = 'bar'"
                          language="ts"
                        />
                      ),
                    },
                  ]}
                />
              ),
            },
            {
              key: '02',
              title: 'item',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
            {
              key: '03',
              title: 'item',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
            {
              key: '04',
              title: 'item',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
            {
              key: '05',
              title: 'item',
              content: (
                <CodeblockContent
                  content="const foo: string = 'bar'"
                  language="ts"
                />
              ),
            },
          ]}
        />
      </>
    </CardTitled>
  </Story>
</Canvas>
